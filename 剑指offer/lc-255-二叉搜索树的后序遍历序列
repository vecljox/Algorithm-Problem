class Solution {
public:
    bool verifyPreorder(vector<int>& preorder) {
        return verifyPreorder(preorder,0,preorder.size()-1);
    }

    bool verifyPreorder(vector<int>& preorder,int i ,int j) {
        if(i>=j)    return true;
        int p =i+1;
        while(p<=j&&preorder[p]<preorder[i])  ++p;
        int m=p;
        while(p<=j&&preorder[p]>preorder[i])  ++p;
        return p==j+1&&verifyPreorder(preorder,i+1,m-1)&&verifyPreorder(preorder,m,j);
    }
};
