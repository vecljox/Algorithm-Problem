# I帧（Intra-coded Frame）是帧内编码，完全独立的帧，不依赖其他帧进行解码
编码速率：最快，因为不需要参考其他帧，只需对当前帧进行帧内压缩。  
解码速率：最快，因为解码时不需要依赖其他帧，只需解码自身即可。

# P 帧（Predicted Frame）
特点：依赖前面的参考帧（I帧或P帧）进行帧间预测。  
解码速率：稍慢于I帧。解码时需要先解码参考帧，然后通过参考帧和差异数据生成完整帧。

# B帧（Bidirectional Predicted Frame）
同时依赖前后的参考帧（I帧或P帧）进行预测，压缩效率最高，解码速率最慢，需要解码前后参考帧。
***
# GOP（Group of Pictures） 是视频编码中的一个基本结构单元，表示一组连续的帧，中文意思是图像组。
GOP 的参数
GOP 的主要参数有两个：

GOP 长度（GOP Length）

指一个 GOP 中帧的总数。

例如，GOP 长度为 30，意味着每 30 帧形成一个新的 GOP。

I-frame 间隔（I-frame Interval）

指每两个 I-frame 之间的帧数，也称为 GOP 间隔。

I-frame 的间隔越大，压缩效率越高，但随机访问性能下降。

## GOP 的应用场景
### 实时直播

通常使用较短的 GOP（如 1-2 秒），减少延迟，提高随机访问性能。

### 视频点播（VOD）

通常使用较长的 GOP（如 5-10 秒），以提高压缩效率，节省存储和带宽。
### 视频编辑

短 GOP 可以减少解码开销，方便快速定位和剪辑。
***
# SPS（Sequence Parameter Set）序列参数集
描述视频序列的全局参数，用于整个视频流的解码。它提供了解码器解码视频所需的基本信息，例如分辨率、帧率、颜色格式（如 YUV 4:2:0）等。
# PPS（Picture Parameter Set）图像参数集
描述单个图像（或帧）解码所需的参数，通常用于补充和细化 SPS 的信息。PPS 是为了提供更灵活的配置而存在的。
包含的信息：
- 熵编码方式（CABAC 或 CAVLC）
- 分区模式（Slice 分割的方式）
- 图像的去块滤波器参数
- 图像预测参数
***
# NALU（Network Abstraction Layer Unit）网络抽象层单元
![image](https://github.com/user-attachments/assets/b785c96d-5b74-4a0a-ae72-e2fa01792f6f)

**NALU是视频编码标准（如 H.264/AVC、H.265/HEVC 等）中的一个基本数据单元。它位于网络抽象层 ，负责将编码后的视频数据组织成适合网络传输和存储的格式。**

## **NALU 的结构**
一个典型的 NALU 由以下几个部分组成：

1. **起始码（Start Code Prefix）**：
   - 用于标识 NALU 的开始，常见的有 `0x 00 00 01` 或 `0x 00 00 00 01`。
   - 在连续的 NALU 中，用于区分不同的 NALU。

2. **NAL 单元头（NAL Unit Header）**：
   - 包含了 NALU 的类型、优先级等信息。
   - 在 H.264 中，NAL 单元头通常是一个字节，格式如下：
     ```
     +---------------+
     |F| NRI |  Type |
     +---------------+
     ```
     - **F**（1 bit）：禁止的位，通常为 0。
     - **NRI**（2 bits）：NALU 优先级。
     - **Type**（5 bits）：指示 NALU 的类型，如 SPS、PPS、I 帧、P 帧等。

3. **NAL 单元负载（NAL Unit Payload）**：
   - 实际的编码视频数据或其他控制信息。
   - 具体内容取决于 NALU 类型。

### **NALU 类型示例（以 H.264 为例）**

- **1 - 23**：非分割片段数据，如 I 帧、P 帧、B 帧等。
- **24-31**：保留用于未来扩展。
- **28**：SPS（Sequence Parameter Set），包含序列参数。
- **29**：PPS（Picture Parameter Set），包含图像参数。

## **NALU 在视频传输中的应用**

### **1. 流媒体传输**

在流媒体传输中，如通过 RTP 协议传输 H.264 视频，视频数据被分割成多个 NALU，封装在 RTP 包中进行传输。接收端根据起始码和 NALU 类型解析视频流，恢复原始视频数据。

### **2. 文件容器**

视频文件格式（如 MP4、MKV）中，NALU 被嵌入到容器中进行存储。这些容器管理 NALU 的顺序、同步信息等，使得视频能够在不同的播放器中正确播放。

### **3. 视频编解码器**

在视频编解码器内部，NALU 用于组织和传输编码后的数据。如在 H.264 编码过程中，视频帧被分割成多个 NALU，便于编码和后续处理。

## **实例解析：H.264 NALU 示例**

假设有一个 H.264 视频流，包含以下 NALU：

1. **SPS（Sequence Parameter Set）**
2. **PPS（Picture Parameter Set）**
3. **I 帧数据**
4. **P 帧数据**

每个 NALU 以起始码开头，后跟 NAL 单元头和负载。例如：

```
00000001 67 ... // SPS
00000001 68 ... // PPS
00000001 65 ... // I 帧
00000001 41 ... // P 帧
```

其中：

- `67` 表示 SPS 类型。
- `68` 表示 PPS 类型。
- `65` 表示 IDR（Instantaneous Decoder Refresh）I 帧。
- `41` 表示 P 帧。

## SPS、PPS与NALU的关系
SPS和PPS都是特殊的NALU：它们被封装在NALU中，并具有特定的nal_unit_type（SPS为7，PPS为8）。

AVC序列头是由SPS和PPS两个NALU构成 ：在流媒体应用中，序列头包含了必要的SPS和PPS数据，以初始化解码器。
### 数据传输顺序 ：
- 发送SPS NALU。
- 发送PPS NALU。
- 发送视频帧NALU（如I帧、P帧等）。

## **总结**

**NALU（Network Abstraction Layer Unit）** 是音视频编码标准中的关键组成部分，负责将编码后的视频数据组织成适合传输和存储的独立单元。通过 NALU，视频数据能够在不同的网络协议、传输环境和存储格式中高效、灵活地传输和处理。理解 NALU 的结构和作用对于从事视频编码、流媒体传输以及多媒体应用开发的工程师来说至关重要。

